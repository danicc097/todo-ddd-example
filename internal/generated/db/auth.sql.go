// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: auth.sql

package db

import (
	"context"

	"github.com/google/uuid"
)

const GetUserAuth = `-- name: GetUserAuth :one
SELECT
  user_id, password_hash, totp_status, totp_secret_cipher, totp_secret_nonce
FROM
  user_auth
WHERE
  user_id = $1
`

func (q *Queries) GetUserAuth(ctx context.Context, db DBTX, userID uuid.UUID) (UserAuth, error) {
	row := db.QueryRow(ctx, GetUserAuth, userID)
	var i UserAuth
	err := row.Scan(
		&i.UserID,
		&i.PasswordHash,
		&i.TotpStatus,
		&i.TotpSecretCipher,
		&i.TotpSecretNonce,
	)
	return i, err
}

const UpsertUserAuth = `-- name: UpsertUserAuth :exec
INSERT INTO user_auth(user_id, totp_status, totp_secret_cipher, totp_secret_nonce, password_hash)
  VALUES ($1, $2, $3, $4, $5)
ON CONFLICT (user_id)
  DO UPDATE SET
    totp_status = EXCLUDED.totp_status,
    totp_secret_cipher = EXCLUDED.totp_secret_cipher,
    totp_secret_nonce = EXCLUDED.totp_secret_nonce,
    password_hash = EXCLUDED.password_hash
`

type UpsertUserAuthParams struct {
	UserID           uuid.UUID `db:"user_id" json:"user_id"`
	TotpStatus       string    `db:"totp_status" json:"totp_status"`
	TotpSecretCipher []byte    `db:"totp_secret_cipher" json:"totp_secret_cipher"`
	TotpSecretNonce  []byte    `db:"totp_secret_nonce" json:"totp_secret_nonce"`
	PasswordHash     *string   `db:"password_hash" json:"password_hash"`
}

func (q *Queries) UpsertUserAuth(ctx context.Context, db DBTX, arg UpsertUserAuthParams) error {
	_, err := db.Exec(ctx, UpsertUserAuth,
		arg.UserID,
		arg.TotpStatus,
		arg.TotpSecretCipher,
		arg.TotpSecretNonce,
		arg.PasswordHash,
	)
	return err
}
